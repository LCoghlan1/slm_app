<div class="card mb-3">
  <div class="row no-gutters">
    <div class="col-2">
      <%= image_tag "CILogo.png" %>
    </div>
    <div class="col-md-8">
      <div class="card-body">
        <h4 class="card-title">Citizens Information - Sick Leave Management Application</h4>
        <hr>
        <p class="card-text">This application is in early development, please report any issues to <a href="mailto:luke.coghlan@ciboard.ie">luke.coghlan@ciboard.ie</a></p>
      </div>
    </div>
  </div>
</div>
<div class="card mb-3">
  <div class="row no-gutters">
    <div class="col-12">
      <div class="card-body">
        <h4 class="card-title">Notice Board</h4>
          <table class="table table-striped mt-4">
          <thead>
            <tr>
              <th><strong>Subject</strong></th>
              <th><strong>Message</strong></th>
              <th><strong>User</strong></th>
              <th><strong>Created At</strong></th>
              <% if current_user.admin %>
                <th colspan="3"></th>
              <% end %>
            </tr>
          </thead>
        
          <tbody>
            <% @messages.each do |message| %>
              <tr>
                <td scope="row"><%= message.title %></td>
                <td><%= message.body %></td>
                <td><%= message.user.firstName %> <%= message.user.lastName %></td>
                <td><%= message.created_at.strftime("%T - %d/%m/%Y") %></td>
                <% if current_user.admin %>
                  <td><%= link_to 'Edit', edit_message_path(message), class: "btn btn-secondary" %></td>
                  <td><%= link_to 'Destroy', message, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-outline-danger" %></td>
                <% end %>
              </tr>
            <% end %>
          </tbody>
        </table>
        <%== pagy_bootstrap_nav(@pagy).html_safe %>
        <% if current_user.admin %>
          <%= link_to 'New Message', new_message_path, class: "btn btn-secondary" %>
        <% end %>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-4">
    <div class="card mb-3" id="home-card">
      <div class="card-header">
        <h5 class="card-title"><center>Employees</center></h5>
      </div>
      <div class="card-body">
        <p>Number of Employees: <%= @employees.count %></p>
        <p>Number of Locations: <%= @employees.distinct.count(:location) %></p>
        <p>List of Locations:</p>
        <ul>
          <% @employees.distinct(:location).pluck(:location).each do |emp| %>
          <li><%= emp %></li>
          <% end %>
        </ul>
        <p style="text-align:center"><%= link_to 'Go to Employee List', employees_path, class: "btn btn-outline-secondary mt-4" %></p>
      </div>
    </div>
  </div>
  <div class="col-4">
    <div class="card mb-3" id="home-card">
      <div class="card-header">
        <h5 class="card-title"><center>Absence Reports</center></h5>
      </div>
      <div class="card-body">
        <p>Total Absences: <%= @absences.count %></p>
        <p>Total Days Absent: <%= @absences.sum(:full_pay) + @absences.sum(:half_pay) %></p>
        <p style="text-align:center"><%= link_to 'Go to Absence Report', absences_path, class: "btn btn-outline-secondary mt-4" %></p>
      </div>
    </div>
  </div>
  <div class="col-4">
    <div class="card mb-3" id="home-card">
      <div class="card-header">
        <h5 class="card-title"><center>Documentation</center></h5>
      </div>
      <div class="card-body">
        <p>List of documentation</p>
        <ul>
          <li>Sick Leave Policy</li>
        </ul>
      </div>
    </div>
  </div>
</div>

